---
title: '告别“完全自建”：为什么 Cloudflare + Brevo 才是适合个人开发者的自定义邮件域名方案'
date: '2025-12-10'
description: '满怀激情地想自建一个酷炫的电子邮局，结果折腾三天后发现，这对于个人开发者来说简直是个安全黑洞和运维噩梦。最终我放弃了“完全自建”，选择了 Cloudflare + Brevo 的组合拳。这套方案不仅零成本，还能完美隐藏服务器 IP，让我可以安心写代码，而不是天天担心服务器被黑。如果你也想省心，这篇文章就是你需要的。'
---
前段时间，在前辈硬核教程的感召下，我满怀热情地尝试在自己的服务器上部署 **Stalwart**。作为一个计算机专业的学生，我觉得“拥有完全属于自己的数据”是一件很酷的事情。

但在深入配置并在服务器上折腾三天后，我最终决定**彻底放弃完全自建方案**，转而使用了 **Cloudflare Email Routing + Brevo SMTP Relay** 的组合。

这不仅仅是因为配置麻烦，更因为我意识到：对于个人开发者来说，完全自建邮局可能是一个“投入产出比”极低的深坑。不仅如此，**对于只有一两台轻量级服务器的个人开发者来说，完全自建邮局简直是一个安全黑洞。**

## 误区：我只想要一个域名邮箱，却被迫运营了一套基础设施

前辈的教程大多专注于“如何把软件跑起来”，却很少提及维护成本和安全代价。冷静下来思考，我的核心需求其实非常简单：
> **我只想用我的域名（`@yewfence.me`）收信和发信。**

为了实现这个简单的功能，完全自建邮局让我陷入了两个巨大的泥潭：

### 1. 安全裸奔：源站 IP 暴露与 CDN 失效
这是最让我后怕的一点。
我们喜欢用 Cloudflare，是因为它可以把我们的云主机（VPS）藏在它的 CDN 后面（开启橙云），防御 DDoS 攻击并隐藏真实 IP。

**但是，自建邮局会打破这个保护罩：**
* **MX 记录必须指向真实 IP**：邮件协议（SMTP/IMAP）无法通过 Cloudflare 免费版的 CDN 代理。这意味着你必须在 DNS 里把 MX 记录指向你服务器的真实公网 IP，并且不能开启小黄云代理。
* **只需一次 Ping**：任何想要攻击你的人，只需要查询一下你域名的 MX 记录，你的源站 IP 就直接暴露了。
* **“连坐”风险**：对于我们这种预算有限的学生，通常只有一台主力 VPS。一旦邮件端口被攻击或者因为 IP 暴露遭到 DDoS，我的个人网站、API 服务、Docker 容器会全部一起挂掉。

### 2. 攻击面激增：防火墙变成了筛子
在部署 Stalwart 之前，我的服务器只需要开放 `80`、`443` 和一个修改过的 SSH 端口，非常安全。
但在配置邮局时，我发现必须开放一堆端口：
* `25` (SMTP 入站)
* `587` (SMTP 提交)
* `465` (SMTPS)
* `143` (IMAP)
* `993` (IMAPS)
* ...

**每一个开放的端口，都是一个潜在的攻击入口。** 对于缺乏专业安全运维经验的个人开发者，守护这么多端口简直是在邀请黑客来扫描。

### 3. 配置复杂度劝退
除了网络层面的风险，软件本身的配置复杂度也远超预期。
这不只是 `docker run` 一下那么简单。为了不被当作垃圾邮件，你需要配置 SPF、DKIM、DMARC、PTR 记录；为了防止病毒和垃圾邮件，你需要配置 Rspamd 或 SpamAssassin；你需要处理证书的自动续期...

这让我感觉我不是在写代码做开发，而是在当一个全职的**系统运维（SysAdmin）**。

## 回归理性：Cloudflare + Brevo 的“收发分离”架构

我想通了，既然我的需求只是“收发信”，为什么要承担运营基础设施的风险？于是我转向了组合拳方案。这个方案的核心思想是：**专业的人做专业的事**。

* **收信端：Cloudflare Email Routing**
* **发信端：Brevo (原 Sendinblue) SMTP Relay**

### 1. 接收：Cloudflare 的隐形盾牌
利用 Cloudflare 的 Email Routing 功能，我配置了自定义域名邮箱（比如 `me@example.com`）转发到我的 Gmail。
* **优势**：完全不需要在 VPS 上运行由 24 小时监听的收件服务，节省了大量的内存和 CPU（对我那台 6GB 内存的 VPS 来说是种解脱）。
* **隐私**：隐藏了源站 IP，且 Cloudflare 的抗攻击能力毋庸置疑。

### 2. 发送：借力 Brevo 的高信誉通道
发送是难点，但我不需要自己发。我注册了 **Brevo** 的免费版（每天 300 封额度，对个人绰绰有余），利用它的 SMTP Relay 服务。
* **优势**：走 587 端口，完美绕过 ISP 的 25 端口封锁。最重要的是，Brevo 的 IP 是经过预热的，送达率极高。

### 3. 关键点：身份的“合法化”
很多人觉得用第三方发信就不“原生”了，其实只要配置好 DNS 记录，体验是一样的。
* **SPF**：在 Cloudflare DNS 里 `include` Brevo 的记录。
* **DKIM**：这是关键，用 Brevo 生成的密钥签名你的邮件，告诉收件方“这是经过域名所有者授权的”。
* **DMARC**：配置好前两项后，DMARC 可以设置为 `p=quarantine` 甚至 `p=reject`，安全性拉满。

## 客户端实操：如何在 Thunderbird 里“登录”我的电子邮箱？
### 收信
对于收信，可能有人会觉得一堆账号的邮件都堆在一个账号里不好管理，实际上解决方法也很简单

1. 在你的收转发邮件的邮箱账号里（比如 Gmail），给你的自定义域名新建一个文件夹(甚至可以给每一个自定义域名的每一个账号设置一个文件夹)
2. 设置一个**过滤器**，把发往 `@yourdomain.com` 的邮件打上移动到对应的文件夹。

这样，你就可以在 Gmail 里清晰地区分发往你自定义域名和发往你Gmail的邮件了。
> 甚至，你可以专门注册一个 Gmail 账号，只用来收发你自定义域名的邮件，彻底隔离开来。

### 发信
这是我最想分享的一个 Tip。很多人以为用了转发服务，就只能用 Gmail 回信，导致暴露真实邮箱。其实 **Thunderbird（雷鸟）** 可以完美解决这个问题。

你不需要在雷鸟里添加一个完整的 IMAP 账户，只需要利用它的 **“身份 (Identities)”** 功能：
1.  在雷鸟的“发送服务器 (SMTP)”设置里，添加并选择 Brevo 的 SMTP 服务器（`smtp-relay.brevo.com`），就像是在各种自托管服务里配置 STMP 服务器一样，填入 Brevo 提供的用户名，端口 `587` ，连接安全选择 `STARTTLS`，验证方式选择 `普通密码`。
2.  在你的主邮箱（如 Gmail）设置里，点击“管理标识...”，选择添加一个发件人身份。
3.  添加你的域名邮箱 `you@yourdomain.com`，你自定义的发件人姓名，在发件服务器里选择你刚刚配置的 Brevo relay 服务器，注意，这里需要与你在 Brevo 配置的发件人信息一致，否则可能无法进行 STMP 转发。
4.  然后，在写邮件时，你就可以从下拉菜单里选择用 `you@yourdomain.com` 作为发件人。
5.  发送测试邮件，填写你的 SMTP API KEY 作为发件密码，检查收件箱，确认邮件通过 Brevo 发出，并且 SPF/DKIM 验证通过。
6.  完成！

> 至少我发给我的 outlook 邮箱的测试邮件完美通过了 SPF 和 DKIM 验证，没有进入垃圾箱。偶尔会被标记为“垃圾邮件”，但这更多是因为 Brevo 的免费账户的 Shared IP 有时会被某些垃圾邮件黑名单误伤，这个问题对于个人用户来说影响不大。

**效果**：当你写信时，下拉菜单选择你的域名邮箱，邮件就会通过 Brevo 发出。对方看到的发件人是 `you@yourdomain.com`，且通过了 SPF/DKIM 验证，完全看不出 Gmail 的痕迹。

## 总结： Simple is Better

前辈的文章固然硬核，展示了技术的可能性，但对于**资源有限、抗风险能力弱**的初学者（比如手里只有一台学生机的我们），完全自建邮局在安全架构上是不划算的。

**技术是为了解决问题，而不是制造更多的问题。**

我想对看过前辈文章的同学们说：**学习原理时，自建邮局是很好的实验；但作为生产力工具，拥抱现代化的 SaaS 组合才是明智之选。**
不要为了造邮局而造邮局，把时间省下来去写更有趣的代码吧

现在的这套方案：**攻击面最小化（Zero Trust 友好）、IP 不泄露、维护成本为零**，已经完美满足了我“使用自己域名沟通”的需求。如果你也像我一样，只想安静地写代码、做网站，而不是每天盯着服务器日志提心吊胆，那么这才是你的最佳选择。